(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-post-detail-post-detail~pages-post-send-post-send"],{"0760":function(e,t,i){var n=i("3eed");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("5e49723a",n,!0,{sourceMap:!1,shadowMode:!1})},"078f":function(e,t,i){"use strict";var n=i("6d22"),a=i.n(n);a.a},"07fe":function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.edit-view[data-v-58e6b53f]{width:100%;height:100%;overflow:auto;word-break:break-all;outline:none;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;white-space:pre-wrap;text-align:left}.edit-view[contenteditable=true][data-v-58e6b53f]{user-modify:read-write-plaintext-only}.edit-view[contenteditable=true][data-v-58e6b53f]:empty:before{content:attr(placeholder);display:block;color:#ccc}',""])},"1bc8":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("v-uni-view",{staticClass:"content"},[i("editDiv",{attrs:{replyUserName:e.replyUserName,pstype:e.pstype},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}})],1),i("v-uni-view",{staticClass:"tools flex"},[i("v-uni-view",{staticClass:"tools-list flex"},["reply"!=e.pstype?i("v-uni-image",{staticClass:"picture_img",attrs:{src:"/static/images/"+("picture"==e.currentTool?"picture_light":"picture_normal")+".png",mode:""},on:{click:function(t){t=e.$handleEvent(t),e.changeTool("picture")}}}):e._e(),i("v-uni-image",{staticClass:"emoticon_img",attrs:{src:"/static/images/"+("emoticon"==e.currentTool?"emoticon_light":"emoticon_normal")+".png",mode:""},on:{click:function(t){t=e.$handleEvent(t),e.changeTool("emoticon")}}}),"send"==e.pstype?i("v-uni-image",{staticClass:"video_img",attrs:{src:"/static/images/"+("video"==e.currentTool?"video_light":"video_normal")+".png",mode:""},on:{click:function(t){t=e.$handleEvent(t),e.changeTool("video")}}}):e._e()],1),i("v-uni-view",{staticClass:"btns flex"},["reply"==e.pstype?i("v-uni-view",{staticClass:"cancel-btn",on:{click:function(t){t=e.$handleEvent(t),e.hideEdit(t)}}},[e._v("取消")]):e._e(),i("v-uni-view",{class:"send-btn "+(e.comment||e.files.length||e.video?"send-btn_active":""),on:{click:function(t){t=e.$handleEvent(t),e.send(t)}}},[e._v("发送")])],1)],1),"picture"==e.currentTool?i("v-uni-view",{staticClass:"imgs"},[e._l(e.files,function(t,n){return"reply"!=e.pstype?i("v-uni-view",{key:n,staticClass:"img pos-rel"},[i("v-uni-image",{attrs:{mode:"scaleToFill",src:t},on:{click:function(i){i=e.$handleEvent(i),e.previewImage(t)}}}),i("v-uni-view",{staticClass:"delete flex pos-abs",on:{click:function(t){t=e.$handleEvent(t),e.deleteImg(n)}}},[i("v-uni-image",{attrs:{src:"/static/images/delete.png"}})],1)],1):e._e()}),i("v-uni-view",{staticClass:"img pos-rel"},[i("v-uni-image",{attrs:{src:"/static/images/upload.png"},on:{click:function(t){t=e.$handleEvent(t),e.chooseImage(t)}}})],1)],2):e._e(),"video"==e.currentTool?i("v-uni-view",{staticClass:"videos pos-rel"},[e.video?e._e():i("v-uni-view",{staticClass:"upload",on:{click:function(t){t=e.$handleEvent(t),e.uploadVideo(t)}}},[e._v("上传")]),e.video?i("v-uni-video",{attrs:{id:"myVideo",src:e.video}}):e._e(),e.video?i("v-uni-view",{staticClass:"delete flex pos-abs",on:{click:function(t){t=e.$handleEvent(t),e.deleteVideo(t)}}},[i("v-uni-image",{attrs:{src:"/static/images/delete.png"}})],1):e._e()],1):e._e(),"emoticon"==e.currentTool?i("v-uni-view",{staticClass:"emoticon"},[i("v-uni-swiper",{on:{change:function(t){t=e.$handleEvent(t),e.swiperChange(t)}}},e._l(e.emojisList,function(t,n){return i("v-uni-swiper-item",{key:n,staticClass:"flex"},e._l(t,function(t,a){return i("v-uni-image",{key:a,attrs:{src:"/static/emojis/"+t+".gif",mode:""},on:{click:function(t){t=e.$handleEvent(t),e.pickEmojis(n,a)}}})}),1)}),1),i("v-uni-view",{staticClass:"indicator flex"},[e._l(e.emojisList.length,function(t,n){return[i("v-uni-view",{key:n+"_0",staticClass:"indicator-item",class:e.currentSwiper==n?"indicator-item-active":""})]})],2)],1):e._e()],1)},a=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a})},2913:function(e,t,i){"use strict";i.r(t);var n=i("60c9"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);t["default"]=a.a},"3eed":function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.content[data-v-0672f0fa]{width:100%;height:%?405?%;padding:%?10?% %?10?%}.comment uni-textarea[data-v-0672f0fa]{width:100%;height:%?405?%;background:#fff;padding-top:%?12?%;padding-left:%?25?%;-webkit-box-sizing:border-box;box-sizing:border-box}.tools[data-v-0672f0fa]{padding:0 %?25?%;height:%?88?%;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;border:%?1?% solid #e5e5e5}.tools .tools-list[data-v-0672f0fa]{-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.tools .tools-list .picture_img[data-v-0672f0fa]{width:%?50?%;height:%?44?%;margin-right:%?20?%}.tools .tools-list .emoticon_img[data-v-0672f0fa]{width:%?52?%;height:%?51?%;margin-right:%?20?%}.tools .tools-list .video_img[data-v-0672f0fa]{width:%?53?%;height:%?43?%}.tools .btns[data-v-0672f0fa]{-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.tools .btns .cancel-btn[data-v-0672f0fa]{width:%?120?%;height:%?70?%;border-radius:%?8?%;font-size:%?24?%;text-align:center;line-height:%?70?%;color:#333;background:#fff;margin-right:%?10?%;border:%?1?% solid #e5e5e5}.tools .btns .send-btn[data-v-0672f0fa]{width:%?120?%;height:%?70?%;border-radius:%?8?%;font-size:%?24?%;text-align:center;line-height:%?70?%;color:#ccc;background:#e8ebf0}.tools .btns .send-btn_active[data-v-0672f0fa]{color:#fff;background:#fcba32}.imgs[data-v-0672f0fa]{padding:%?30?% %?30?% 0}.imgs .img[data-v-0672f0fa]{width:%?112?%;height:%?112?%;margin-right:%?20?%;display:inline-block}.imgs .img>uni-image[data-v-0672f0fa]{width:100%;height:100%;border:%?1?% solid #e5e5e5}.imgs .img>uni-image[data-v-0672f0fa]:last-child{background:#fff;border:0}.imgs .img .delete[data-v-0672f0fa]{width:%?50?%;height:%?50?%;top:%?-20?%;right:%?-20?%}.imgs .img .delete uni-image[data-v-0672f0fa]{width:100%;height:100%;margin:auto}.videos[data-v-0672f0fa]{padding:%?30?% %?30?% 0}.videos .upload[data-v-0672f0fa]{width:%?176?%;height:%?66?%;text-align:center;line-height:%?66?%;color:#fff;background:#fcba32}.videos uni-video[data-v-0672f0fa]{width:100%;margin-top:%?20?%}.videos .delete[data-v-0672f0fa]{width:%?80?%;height:%?80?%;top:%?10?%;right:%?-10?%}.videos .delete uni-image[data-v-0672f0fa]{width:%?50?%;height:%?50?%;margin:auto}.emoticon uni-swiper[data-v-0672f0fa]{width:100%;height:%?240?%}.emoticon uni-swiper uni-swiper-item[data-v-0672f0fa]{padding:%?30?% %?50?% 0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.emoticon uni-swiper uni-swiper-item uni-image[data-v-0672f0fa]{width:%?60?%;height:%?60?%;margin:0 %?16?%}.emoticon uni-swiper uni-swiper-item uni-image[data-v-0672f0fa]:nth-child(7n+7){margin-right:0}.emoticon .indicator[data-v-0672f0fa]{width:100%;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.emoticon .indicator .indicator-item[data-v-0672f0fa]{width:%?22?%;height:%?22?%;margin-right:%?15?%;border-radius:50%;background:#b2b2b2}.emoticon .indicator .indicator-item-active[data-v-0672f0fa]{background:#666}',""])},"60c9":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(i("a34a")),a=i("3e16"),o=s(i("e29a"));s(i("3b2c"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t,i,n,a,o,s){try{var r=e[o](s),c=r.value}catch(l){return void i(l)}r.done?t(c):Promise.resolve(c).then(n,a)}function c(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var o=e.apply(t,i);function s(e){r(o,n,a,s,c,"next",e)}function c(e){r(o,n,a,s,c,"throw",e)}s(void 0)})}}function l(e){return f(e)||d(e)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function d(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function f(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}var h={components:{editDiv:o.default},props:{pstype:{type:String,default:"send"},replyUserName:{type:String,default:""}},data:function(){return{currentTool:"emoticon",comment:"",comments:"",files:[],filesUpload:[],video:"",videoUpload:"",success:0,fail:0,emojisList:[["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19"],["20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39"],["40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],["60","61","52","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79"],["80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99"],["100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119"],["120","121","122","123","124","125","126","127","128","129","130","131","132","133","134"]],currentSwiper:0}},onLoad:function(e){},onShow:function(){},mounted:function(){},methods:{changeTool:function(e){this.files.length&&"video"==e||this.video&&"picture"==e?uni.showToast({title:"图片和视频不能同时上传",icon:"none"}):this.currentTool=e},chooseImage:function(e){var t=this;this.files.length>=9?uni.showToast({title:"最多上传9张",icon:"none"}):uni.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){uni.showLoading({title:"正在上传图片...",mask:!0});var i=e.tempFilePaths;if(t.files.length+e.tempFilePaths.length>9)uni.showToast({title:"您已上传"+t.files.length+"张,还可上传"+(9-t.files.length)+"张",icon:"none"});else for(var n in i)t.uploadimg(i,n).then(function(e){0===t.fail?uni.showToast({title:"上传成功",icon:"none"}):t.fail<i.length?uni.showToast({title:"上传成功"+t.success+"张,失败"+t.fail+"张",icon:"none"}):uni.showToast({title:"上传失败",icon:"none"}),t.success=0,t.fail=0})},fail:function(e){uni.hideLoading()}})},uploadimg:function(e,t,i){var n=this;return new Promise(function(i,a){var o=n;uni.uploadFile({url:o.$globalData.baseUrl+"posting/putPostingAsImg",filePath:e[t],name:"file",method:"post",success:function(e){var t=o.$globalData.uploadImgUrl+JSON.parse(e.data).data.imageUriPath,i=JSON.parse(e.data).data.imageUriPath;o.files=[].concat(l(o.files),[t]),o.filesUpload=[].concat(l(o.filesUpload),[i]),o.success=o.success+1},fail:function(e){o.fail=o.fail+1},complete:function(){t==e.length-1&&i(!0)}})})},previewImage:function(e){uni.previewImage({current:e,urls:this.files})},deleteImg:function(e){var t=e,i=this.files;for(var n in i)n==t&&i.splice(n,1);var a=this.filesUpload;for(var o in a)o==t&&a.splice(o,1);this.files=i,this.filesUpload=a},swiperChange:function(e){this.currentSwiper=e.detail.current},pickEmojis:function(e,t){this.comment+='<img src="'.concat("/shunfengshan/","static/emojis/").concat(this.emojisList[e][t],'.gif" mode="" />'),this.comments+='<img src="/static/emojis/'.concat(this.emojisList[e][t],'.gif" mode="" />')},uploadVideo:function(){var e=this;uni.chooseVideo({sourceType:["album","camera"],maxDuration:60,camera:"back",success:function(t){uni.showLoading({title:"正在上传视频...",mask:!0}),console.log(t.tempFilePath),uni.uploadFile({url:e.$globalData.baseUrl+"posting/putPostingAsImg",filePath:t.tempFilePath,name:"file",success:function(t){e.video=e.$globalData.uploadHeadImgUrl+JSON.parse(t.data).data.imageUriPath,e.videoUpload=JSON.parse(t.data).data.imageUriPath,uni.showToast({title:"上传成功",icon:"none"})},fail:function(e){uni.showToast({title:"上传失败",icon:"none"})}})},fail:function(e){uni.hideLoading()}})},deleteVideo:function(){this.video="",this.videoUpload=""},hideEdit:function(){this.$emit("closeEdit")},confirmLogin:function(){uni.showModal({title:"登录提示",content:"您暂未登录，是否去登录",success:function(e){e.confirm&&uni.redirectTo({url:"/pages/login/login"})}})},send:function(){var e=c(n.default.mark(function e(t){var i,o,s;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=uni.getStorageSync("userInfo"),i&&i.userid){e.next=5;break}this.confirmLogin(),e.next=18;break;case 5:if(this.comment||this.files.length||this.video){e.next=7;break}return e.abrupt("return");case 7:if(o=this.comment,o=o.replace(new RegExp("/shunfengshan/","g"),"/"),"send"!=this.pstype){e.next=17;break}return uni.showLoading({title:"正在发送",mask:!0}),e.next=13,(0,a.UserSendPost)({content:o,imgurl:this.filesUpload.toString(),vediourl:this.videoUpload,userid:uni.getStorageSync("userInfo").userid});case 13:s=e.sent,s&&(uni.showToast({title:"发帖成功,请等待审核通过",icon:"none"}),setTimeout(function(e){uni.navigateBack({delta:1})},1e3)),e.next=18;break;case 17:this.$emit("submitSend",o,this.files);case 18:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},onReachBottom:function(){},onPullDownRefresh:function(){}};t.default=h},"6d22":function(e,t,i){var n=i("07fe");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("5b937d3e",n,!0,{sourceMap:!1,shadowMode:!1})},8218:function(e,t,i){"use strict";i.r(t);var n=i("1bc8"),a=i("2913");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("f119");var s=i("2877"),r=Object(s["a"])(a["default"],n["a"],n["b"],!1,null,"0672f0fa",null);t["default"]=r.exports},9582:function(e,t,i){"use strict";i.r(t);var n=i("b09c"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);t["default"]=a.a},b09c:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={name:"editView",props:{value:{type:String,default:""},canEdit:{type:Boolean,default:!0},pstype:{type:String,default:"send"},replyUserName:{type:String,default:""}},data:function(){return{innerText:this.value,isLocked:!1}},mounted:function(){this.$refs.edit.focus()},watch:{value:{handler:function(e,t){var i=this;this.isLocked&&this.innerText||(this.innerText=this.value,setTimeout(function(t){'mode="" />'!=e.substring(e.length-10,e.length)&&i.keepLastIndex()},5))},deep:!0}},methods:{changeText:function(){var e=this;this.$emit("input",this.$el.innerHTML),setTimeout(function(t){e.keepLastIndex()},5)},keepLastIndex:function(){var e=this.$refs.edit;if(window.getSelection){e.focus();var t=window.getSelection();t.selectAllChildren(e),t.collapseToEnd()}else if(document.selection){t=document.selection.createRange();t.moveToElementText(e),t.collapse(!1),t.select()}}}};t.default=n},d21e:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"edit",staticClass:"edit-view",attrs:{contenteditable:e.canEdit,placeholder:e.innerText?"":"send"==e.pstype?"写几句准备发表帖子啦...":e.replyUserName?"回复 "+e.replyUserName:"写几句评论一下..."},domProps:{innerHTML:e._s(e.innerText)},on:{focus:function(t){t=e.$handleEvent(t),e.isLocked=!0},blur:function(t){t=e.$handleEvent(t),e.isLocked=!1},input:function(t){t=e.$handleEvent(t),e.changeText(t)}}})},a=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a})},e29a:function(e,t,i){"use strict";i.r(t);var n=i("d21e"),a=i("9582");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("078f");var s=i("2877"),r=Object(s["a"])(a["default"],n["a"],n["b"],!1,null,"58e6b53f",null);t["default"]=r.exports},f119:function(e,t,i){"use strict";var n=i("0760"),a=i.n(n);a.a}}]);